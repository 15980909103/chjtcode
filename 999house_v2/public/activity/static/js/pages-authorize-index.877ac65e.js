(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-authorize-index"],{"1b8a":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.doType?a("v-uni-view",{staticClass:"content"},[a("v-uni-view",{staticClass:"userinfo"},[a("v-uni-view",{staticClass:"userinfo-avatar"},[a("v-uni-image",{attrs:{mode:"widthFix",src:t.$api.imgDirtoUrl("/my/logo.png")}})],1),a("v-uni-text",[t._v("九房小程序")])],1),"userinfo"==t.doType?[a("v-uni-view",{staticClass:"content"},[a("v-uni-view",[t._v("申请获取以下权限")]),a("v-uni-text",[t._v("获得你的公开信息(昵称，头像等)")])],1),a("v-uni-view",{staticClass:"bottom-box"},[a("v-uni-button",{staticClass:"cancel-bottom",attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancel.apply(void 0,arguments)}}},[t._v("取消")]),t.canIUse?a("v-uni-button",{staticClass:"user-bottom",attrs:{"open-type":"getUserInfo",type:"primary"},on:{getuserinfo:function(e){arguments[0]=e=t.$handleEvent(e),t.bindGetUserInfo.apply(void 0,arguments)}}},[t._v("授权登录")]):a("v-uni-view",[t._v("请升级微信版本")])],1)]:t._e(),"mobile"==t.doType?[a("v-uni-view",{staticClass:"content"},[a("v-uni-view",[t._v("申请获取以下权限")]),a("v-uni-text",[t._v("获得你的手机号信息")])],1),a("v-uni-view",{staticClass:"bottom-box"},[a("v-uni-button",{staticClass:"cancel-bottom",attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancel.apply(void 0,arguments)}}},[t._v("取消")]),a("v-uni-button",{staticClass:"user-bottom",attrs:{"open-type":"getPhoneNumber",type:"primary"},on:{getphonenumber:function(e){arguments[0]=e=t.$handleEvent(e),t.getphonenumber.apply(void 0,arguments)}}},[t._v("获取手机号")])],1)]:t._e()],2):t._e()},o=[]},"43fa":function(t,e,a){"use strict";var n=a("4609"),i=a.n(n);i.a},4609:function(t,e,a){var n=a("794a");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("1e4b2cde",n,!0,{sourceMap:!1,shadowMode:!1})},"71cb":function(t,e,a){"use strict";a.r(e);var n=a("9782"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},"794a":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i," /* pages/authorize/index.wxss */.userinfo[data-v-5dd4c689]{position:relative;width:100%;height:%?320?%;color:#000;font-size:%?34?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.userinfo-avatar[data-v-5dd4c689]{overflow:hidden;display:block;width:%?160?%;height:%?160?%;margin:%?20?%;margin-top:%?50?%;border-radius:50%;border:2px solid #fff\r\n  /* box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2); */}.userinfo-avatar uni-image[data-v-5dd4c689]{width:100%}.content[data-v-5dd4c689]{padding:0 %?50?%;\r\n    /* margin-left: 50rpx; */margin-top:%?30?%;margin-bottom:%?90?%}.content uni-text[data-v-5dd4c689]{display:block;color:#9d9d9d;margin-top:%?40?%}.bottom-box[data-v-5dd4c689]{margin:%?70?% auto;width:100%;text-align:center}.bottom-box uni-button[data-v-5dd4c689]{width:100%;margin:%?20?% 0;height:%?100?%;line-height:%?100?%}.user-bottom[data-v-5dd4c689]{border-radius:%?80?%;font-size:%?35?%;float:right;\r\n\t\r\n    /* width: 49% !important; */border:none!important;border-radius:%?12?%;\r\n    /* line-height: 75rpx; */background-color:#ea6101!important}.user-bottom[data-v-5dd4c689]::after,.cancel-bottom[data-v-5dd4c689]::after{border:none}.cancel-bottom[data-v-5dd4c689]{border-radius:%?80?%;font-size:%?35?%;float:left;\r\n    /* width: 49% !important; */border:none!important;border-radius:%?12?%\r\n    /* line-height: 75rpx; */}",""]),t.exports=e},9782:function(t,e,a){"use strict";(function(t){a("c975"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=getApp(),i=null,o={data:function(){return{isclick:!1,doType:"userinfo",canIUse:uni.canIUse("button.open-type.getUserInfo"),hasGetMobile:1}},onLoad:function(){i=this,uni.getSetting({success:function(t){t.authSetting["scope.userInfo"]&&n.globalData.token&&1==i.hasGetMobile?i.$data.doType="mobile":i.$data.doType="userinfo"},fail:function(){i.$data.doType="userinfo"}})},methods:{bindGetUserInfo:function(e){1!=i.$data.isclick&&(i.$data.isclick=!0,e.detail.encryptedData?i.$api.wxMiniAuthLogin(n,{encryptedData:e.detail.encryptedData,iv:e.detail.iv}).then((function(e){i.$data.isclick=!1,t.log(e,"authpage"),e?1==i.hasGetMobile?(i.$data.doType="",uni.showLoading({title:"加载中"}),setTimeout((function(){uni.hideLoading(),i.$data.doType="mobile"}),300)):i.doResponse(e):i.$toast("授权失败:"+e+"请重试")})):(i.$data.isclick=!1,t.log("授权失败")))},cancel:function(){var t=getCurrentPages();t.length>1?i.goPage(-1):i.goPage("index/index","","reLaunch"),n.globalData.restopen=""},getphonenumber:function(e){1!=i.$data.isclick&&(i.$data.isclick=!0,e.detail&&e.detail.encryptedData?i.$api.getMiniMobile({url:"public/getWxPhone",encryptedData:e.detail.encryptedData,iv:e.detail.iv}).then((function(t){i.$data.isclick=!1,i.doResponse(t)})).catch((function(e){t.log(e)})):e.detail&&-1!=e.detail.errMsg.indexOf("user deny")?i.$data.isclick=!1:(i.$data.isclick=!1,i.$toast("手机获取失败")))},doResponse:function(t){n.globalData.userInfo||(n.globalData.userInfo={}),n.globalData.userInfo=Object.assign(n.globalData.userInfo,t),i.$api.getUserInfoByCache(t),uni.$emit("loginOk");var e=getCurrentPages();if(e.length>1)n.globalData.restopen?i.goPage(n.globalData.restopen,"","redirectTo"):i.goPage(-1);else if(n.globalData.restopen)i.goPage(n.globalData.restopen,"","reLaunch");else{var a=i.$api.getLaunchData();i.goPage(a.$url,"","reLaunch")}n.globalData.restopen=""}}};e.default=o}).call(this,a("5a52")["default"])},bf91:function(t,e,a){"use strict";a.r(e);var n=a("1b8a"),i=a("71cb");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("43fa");var r,d=a("f0c5"),c=Object(d["a"])(i["default"],n["b"],n["c"],!1,null,"5dd4c689",null,!1,n["a"],r);e["default"]=c.exports}}]);