{"version":3,"sources":["uni-app:///main.js","webpack:///D:/code/999house_v2/front_end/mini2/pages/chat/chat.vue?6d4a","webpack:///D:/code/999house_v2/front_end/mini2/pages/chat/chat.vue?a17f","webpack:///D:/code/999house_v2/front_end/mini2/pages/chat/chat.vue?906b","webpack:///D:/code/999house_v2/front_end/mini2/pages/chat/chat.vue?d0cf","uni-app:///pages/chat/chat.vue","webpack:///D:/code/999house_v2/front_end/mini2/pages/chat/chat.vue?5714"],"names":["createPage","Page","renderjs","component","options","__file","components","uButton","uImage","uLoadmore","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","s0","_self","_c","__get_style","haveVal","width","padding","l0","__map","list","item","index","$orig","__get_orig","g0","$api","imgDirtoUrl","send_head","g1","msg_type","msg_url","g2","_isMounted","e0","val","detail","value","$mp","data","Object","assign","$root","recyclableRender","staticRenderFns","_withStripped"],"mappings":"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","file":"pages/chat/chat.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=bf16e7f4&scoped=true&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bf16e7f4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat.vue\"\nexport default component.exports","export * from \"-!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=bf16e7f4&scoped=true&\"","var components\ntry {\n  components = {\n    uButton: function() {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-button/u-button\" */ \"@/uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uImage: function() {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-image/u-image\" */ \"@/uview-ui/components/u-image/u-image.vue\"\n      )\n    },\n    uLoadmore: function() {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-loadmore/u-loadmore\" */ \"@/uview-ui/components/u-loadmore/u-loadmore.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var s0 = _vm.__get_style([\n    !_vm.haveVal\n      ? {\n          width: \"82rpx\",\n          padding: \"0 14rpx\"\n        }\n      : {\n          width: 0,\n          padding: 0\n        }\n  ])\n\n  var l0 = _vm.__map(_vm.list, function(item, index) {\n    var $orig = _vm.__get_orig(item)\n\n    var g0 = _vm.$api.imgDirtoUrl(item.send_head)\n    var g1 = !(item.msg_type == 1) ? _vm.$api.imgDirtoUrl(item.msg_url) : null\n    var g2 = !(item.msg_type == 1) ? _vm.$api.imgDirtoUrl(item.msg_url) : null\n    return {\n      $orig: $orig,\n      g0: g0,\n      g1: g1,\n      g2: g2\n    }\n  })\n\n  if (!_vm._isMounted) {\n    _vm.e0 = function(e) {\n      _vm.val = e.detail.value\n    }\n  }\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        s0: s0,\n        l0: l0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\" @click=\"closeMore\">\r\n\t\t\r\n\t\t<view class=\"bar\" id=\"bar\" :style=\"{ transform: `translateY(${ moreShow ? '0' : '196rpx' })` }\" @click.stop>\r\n\t\t\t<view class=\"action\">\r\n\t\t\t\t<view class=\"input\">\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tclass=\"u-input__input u-input__textarea\"\r\n\t\t\t\t\t\t:value=\"val\"\r\n\t\t\t\t\t\t:style=\"{\r\n\t\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\t\tbackground: '#fff',\r\n\t\t\t\t\t\t\tfontSize: '30rpx',\r\n\t\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t\t\tpadding: '0 16rpx',\r\n\t\t\t\t\t\t\tmargin: '10rpx 0'\r\n\t\t\t\t\t\t}\"\r\n\t\t\t\t\t\tplaceholder=\" \"\r\n\t\t\t\t\t\t:fixed=\"true\"\r\n\t\t\t\t\t\t:focus=\"myfocus\"\r\n\t\t\t\t\t\t:hold-keyboard=\"true\"\r\n\t\t\t\t\t\t:autoHeight=\"true\"\r\n\t\t\t\t\t\t:show-confirm-bar=\"false\"\r\n\t\t\t\t\t\tcursor-spacing=\"22\"\r\n\t\t\t\t\t\t:adjust-position=\"adjust\"\r\n\t\t\t\t\t\t@input=\"(e)=>{ val = e.detail.value }\"\r\n\t\t\t\t\t\t@focus=\"onFocus\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t<!-- \t\r\n\t\t\t\t\t@focus=\"onFocus\"\r\n\t\t\t\t\t@confirm=\"onConfirm\" -->\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"more\">\r\n\t\t\t\t\t<i \r\n\t\t\t\t\t\tclass=\"iconfont iconjia\" \r\n\t\t\t\t\t\t:style=\"[ \r\n\t\t\t\t\t\t\t!haveVal ? { width: '82rpx', padding: '0 14rpx'} : { width: 0, padding: 0}\r\n\t\t\t\t\t\t]\" \r\n\t\t\t\t\t\t@click=\"showMore\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t</i>\r\n\t\t\t\t\t<view class=\"send\" :style=\"{ width: haveVal ? '140rpx' : 0 }\">\r\n\t\t\t\t\t\t<u-button type=\"warning\" @click.stop=\"send(0)\">发送</u-button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"choose\">\r\n\t\t\t\t<view class=\"choose-box\">\r\n\t\t\t\t\t<view class=\"choose-item\" @tap=\"choosePic(1)\">\r\n\t\t\t\t\t\t<i class=\"iconfont icontupian\"></i>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text>照片</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"choose-box\">\r\n\t\t\t\t\t<view class=\"choose-item\" @tap=\"choosePic(2)\">\r\n\t\t\t\t\t\t<i class=\"iconfont iconpaizhao\"></i>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text>拍照</text>\r\n\t\t\t\t</view> \r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view \r\n\t\t\tclass=\"wrap\" \r\n\t\t\t:style=\"[ \r\n\t\t\t\t { transform: `translateY(-${wrapTransform}rpx) rotateX(180deg)` },\r\n\t\t\t\t { opacity: pageShow ? 1 : 0 },\r\n\t\t\t\t { paddingTop: wrapPadding + 'rpx' }\r\n\t\t\t]\"\r\n\t\t>\r\n\t\t\t<template v-for=\"(item,index) in list\">\r\n\t\t\t\t<view class=\"item\" :class=\"item.send_user_id != to_uid ? 'item-right' : ''\" :key=\"index\">\r\n\t\t\t\t\t<view class=\"item-head\">\r\n\t\t\t\t\t\t<u-image\r\n\t\t\t\t\t\t\twidth=\"60rpx\" \r\n\t\t\t\t\t\t\theight=\"60rpx\" \r\n\t\t\t\t\t\t\tshape=\"circle\"\r\n\t\t\t\t\t\t\tmode=\"heightFix\" \r\n\t\t\t\t\t\t\tborder-radius=\"12\"\r\n\t\t\t\t\t\t\tduration=\"300\"\r\n\t\t\t\t\t\t\tbg-color=\"red\"\r\n\t\t\t\t\t\t\tshow-menu-by-longpress\r\n\t\t\t\t\t\t\t:src=\"$api.imgDirtoUrl(item.send_head)\"\r\n\t\t\t\t\t\t\t@click.stop=\"lookPic(item.send_head)\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</u-image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"item-wrap\">\r\n\t\t\t\t\t\t<template v-if=\"item.msg_type == 1\">\r\n\t\t\t\t\t\t\t<view class=\"item-content\">\r\n\t\t\t\t\t\t\t\t{{ item.msg }}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<view class=\"item-img\">\r\n\t\t\t\t\t\t\t\t<u-image \r\n\t\t\t\t\t\t\t\t\twidth=\"100%\" \r\n\t\t\t\t\t\t\t\t\theight=\"300rpx\" \r\n\t\t\t\t\t\t\t\t\tmode=\"heightFix\" \r\n\t\t\t\t\t\t\t\t\tborder-radius=\"12\"\r\n\t\t\t\t\t\t\t\t\tshow-menu-by-longpress\r\n\t\t\t\t\t\t\t\t\tduration=\"300\"\r\n\t\t\t\t\t\t\t\t\t:src=\"$api.imgDirtoUrl(item.msg_url)\"\r\n\t\t\t\t\t\t\t\t\t@click.stop=\"lookPic(item.msg_url)\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</u-image>\r\n\t\t\t\t\t\t\t\t{{ $api.imgDirtoUrl(item.msg_url) }}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t\t<u-loadmore class=\"loading\" status=\"loading\"  v-if=\"loadShow\"/>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: -1,\t\t\t\t//\t会话id\r\n\t\t\t\tto_uid: -1,\r\n\t\t\t\totherName: '',\t\t//\t对方名称\r\n\t\t\t\t\r\n\t\t\t\tscreenHeight: 0,\t//\t可视高度\r\n\t\t\t\tpageShow: false,\t//\t页面显示 防止闪动\r\n\t\t\t\tloadShow: false,\r\n\t\t\t\t\r\n\t\t\t\tval: '',\t\t\t//\t输入值\r\n\t\t\t\tmoreShow: false,\t//\t显示照相相册\r\n\t\t\t\twrapTransform: 0,\t//\t显示照相相册时偏移值\r\n\t\t\t\twrapPadding: 100,\r\n\t\t\t\tmyfocus: false,\t\t//\t获取焦点\r\n\t\t\t\t\r\n\t\t\t\tscreenMove: false,\r\n\t\t\t\t\r\n\t\t\t\t// 上推页面\r\n\t\t\t\tadjust: true,\r\n\t\t\t\t\r\n\t\t\t\t// 数据\r\n\t\t\t\tlist: [],\r\n\t\t\t\t\r\n\t\t\t\tpage: 0,\r\n\t\t\t\tmaxPage: 1,\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\t\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tlist( newV ){\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\thaveVal() {\r\n\t\t\t\tlet val = this.$u.trim(this.val);\r\n\t\t\t\t\r\n\t\t\t\tval = val == '' ? false : true;\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\t\tthis.pageShow && this.$u.getRect('.action').then(res => {\r\n\t\t\t\t\tlet val = res.height * 2;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif( this.wrapPadding == val ) return;\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.wrapPadding = val;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif( this.wrapPadding > val ) return;\r\n\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\tthis.scrollNewText();\r\n\t\t\t\t\t},50)\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\tthis.init(option);\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinit(option) {\r\n\t\t\t\tthis.id = option.id;\r\n\t\t\t\tthis.otherName = option.name;\r\n\t\t\t\tthis.to_uid = option.to_uid;\r\n\r\n\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t    title: option.name\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tuni.getSystemInfo({\r\n\t\t\t\t    success: (res)=>{\r\n\t\t\t\t\t\tif( !this.screenHeight ){\r\n\t\t\t\t\t\t\tthis.screenHeight = res.windowHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t    }\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tthis.getData();\r\n\t\t\t},\r\n\t\t\t// 获取数据\r\n\t\t\tgetData(call) {\r\n\t\t\t\tlet page = this.page;\r\n\t\t\t\t\r\n\t\t\t\tpage++;\r\n\t\t\t\t\r\n\t\t\t\tif(call && page != 1 && this.loadShow) return;\r\n\t\t\t\t\r\n\t\t\t\tthis.$http.post( 'chat/getChatListBYDialogueId', {\r\n\t\t\t\t\tdialogue_id: this.id,\r\n\t\t\t\t\ttype: 'up',\r\n\t\t\t\t\tpage: page,\r\n\t\t\t\t\tpageSize: 20\r\n\t\t\t\t}).then( res=>{\r\n\t\t\t\t\tlet data = res.data.list;\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.page = res.data.current_page;\r\n\t\t\t\t\tthis.maxPage = res.data.last_page;\r\n\t\t\t\t\t\r\n\t\t\t\t\tcall && call();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// console.log(data)\r\n\t\t\t\t\tthis.list.push(...data);\r\n\t\t\t\t\r\n\t\t\t\t\tif(page == 1){\r\n\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\tthis.scrollNewText();\r\n\t\t\t\t\t\t}, 300)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.listenNewTalk();\r\n\t\t\t\t\t}                     \r\n\t\t\t\t\t\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t// 判断是否有历史记录\r\n\t\t\t\t\t\tif( this.page < this.maxPage ){\r\n\t\t\t\t\t\t\tthis.loadShow = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tlistenNewTalk() {\r\n\t\t\t\tconst that = this;\r\n\t\t\t\t\r\n\t\t\t\tuni.$on('some_talk_detail', (e)=>{\r\n\t\t\t\t\t\r\n\t\t\t\t\tconsole.log(e,1111);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif( that.id == 0 ){\r\n\t\t\t\t\t\tthat.id = e.chat_dialogue_id;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 刷新联系人页面\r\n\t\t\t\t\t\tuni.$emit('refFriends'); \r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif( !that.id || (that.id != e.chat_dialogue_id) ) return;\r\n\t\t\t\t\t\r\n\t\t\t\t\tthat.list.unshift(e);\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.sendSocketMessage({\r\n\t\t\t\t\t\tdata: JSON.stringify({\r\n\t\t\t\t\t\t\turl: 'wliao/Index/setMsgStatus',\r\n\t\t\t\t\t\t\tdialogue_id: that.id\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tscrollNewText() {\r\n\t\t\t\tthis.$u.getRect('.wrap').then(res => {\r\n\t\t\t\t\tlet height = res.height;\r\n\r\n\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t    scrollTop: height,\r\n\t\t\t\t\t    duration: 0\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.$nextTick(()=>{\r\n\t\t\t\t\t\tthis.pageShow = true;\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tsend( url ) {\r\n\t\t\t\tif( !url && !this.haveVal ) return;\r\n\t\t\t\t\r\n\t\t\t\tconst that = this;\r\n\t\t\t\t\r\n\t\t\t\tconst obj = {\r\n\t\t\t\t\turl: 'wliao/Index/usertouser',\r\n\t\t\t\t\tmsg_type: url ? 2 : 1,\r\n\t\t\t\t\tto_user_id: that.to_uid,\r\n\t\t\t\t\tsend_msg: url ? '' : that.val,\r\n\t\t\t\t\tmsg_url: url ? url : '',\r\n\t\t\t\t\tgroup_id: 0\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// const myMsg = {\r\n\t\t\t\t// \tchat_dialogue_id: that.id,\r\n\t\t\t\t// \tmsg: url ? '' : that.val,\r\n\t\t\t\t// \tmsg_type: url ? 2 : 1,\r\n\t\t\t\t// \tmsg_url: url ? url : '',\r\n\t\t\t\t// \tto_user_id: that.to_uid,\r\n\t\t\t\t// \tsend_user_id: getApp().globalData.userInfo.id,\r\n\t\t\t\t// \tsend_head: getApp().globalData.userInfo.headimgurl,\r\n\t\t\t\t// \tsend_name: getApp().globalData.userInfo.nickname,\r\n\t\t\t\t// \tto_name: that.otherName,\r\n\t\t\t\t// \ttu_head: \"\"\r\n\t\t\t\t// }\r\n\r\n\t\t\t\tuni.sendSocketMessage({\r\n\t\t\t\t\tdata: JSON.stringify(obj),\r\n\t\t\t\t\tsuccess: (res)=>{\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t// that.list.unshift(myMsg);\r\n\t\t\t\t\t\tuni.$emit('some_talk', { id: that.id, val: url ? '' : that.val, type: url ? 2 : 1});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res)=>{\r\n\t\t\t\t\t\tuni.$emit('socketErr');\r\n\t\t\t\t\t\tconsole.log(JSON.stringify(res),777)\r\n\t\t\t\t\t\tthat.$toast('服务器异常，请检查网络后重试',JSON.stringify(res))\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\tthis.val = '';\r\n\t\t\t\tthis.closeMore();\r\n\t\t\t\t\r\n\t\t\t\tthis.scrollNewText();\r\n\t\t\t},\r\n\t\t\tshowMore() {\r\n\t\t\t\tthis.$u.getRect('.wrap').then(res => {\r\n\t\t\t\t\tlet height = res.height;\r\n\t\t\t\t\tthis.moreShow = !this.moreShow;\r\n\t\t\t\t\tif( height >= this.screenHeight - 148 ){\r\n\t\t\t\t\t\tthis.wrapTransform = !this.moreShow ? 0 : 196;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcloseMore( e ) {\r\n\t\t\t\tthis.myfocus = this.moreShow = false;\r\n\t\t\t\tthis.wrapTransform = 0;\r\n\t\t\t},\r\n\t\t\tonFocus() {\r\n\t\t\t\tthis.myfocus = true;\r\n\t\t\t\tthis.scrollNewText();\r\n\t\t\t},\r\n\t\t\tchoosePic(type) {\r\n\t\t\t\tconst sourceType = type == 1 ? 'album' : 'camera';\r\n\t\t\t\t\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tsourceType: sourceType,\r\n\t\t\t\t\tsuccess: (e)=>{\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\te.tempFiles.map( item=>{\r\n\t\t\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\t\t\turl: getApp().globalData.host_api+'/upload/imgUpload',\r\n\t\t\t\t\t\t\t\tname: 'image',\r\n\t\t\t\t\t\t\t\tfilePath: item.path,\r\n\t\t\t\t\t\t\t\tcomplete: (e)=>{\r\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(e.data);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// console.log(data,777)\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif( data && data.code == 1){\r\n\t\t\t\t\t\t\t\t\t\tconst url = data.data.info.url;\r\n\t\t\t\t\t\t\t\t\t\tthis.send(url);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.$toast('图片上传失败');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tlookPic( pic ){\r\n\t\t\t\tpic = this.$api.imgDirtoUrl(pic);\r\n\t\t\t\t\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\turls: [pic]\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tonPageScroll(e) {\r\n\t\t\tif( !this.loadShow || e.scrollTop > 400 ) return;\r\n\t\t\t\r\n\t\t\t// 加载历史\r\n\t\t\tthis.$u.debounce(()=>{\r\n\t\t\t\tthis.loadShow = false;\r\n\t\t\t\t\r\n\t\t\t\tthis.getData(()=>{\r\n\t\t\t\t\tconsole.log(e.scrollTop)\r\n\t\t\t\t\tif( e.scrollTop < 10 ){\r\n\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\tscrollTop: 10,\r\n\t\t\t\t\t\t\tduration: 0\r\n\t\t\t\t\t\t}); \r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},300)\r\n\t\t}\r\n\t}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.content{\r\n\t\twidth: 100%;\r\n\t\tmin-height: 100vh;\r\n\t\tbackground-color: rgba(245, 245, 245, 1);\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.wrap{\r\n\t\t// padding-top: 100rpx;\r\n\t\ttransition: .3s;\r\n\t}\r\n\t\r\n\t.loading{\r\n\t\t/deep/.u-load-more-wrap{\r\n\t\t\tpadding: 50rpx 0 20rpx;\r\n\t\t\ttransform: rotateX(180deg);\r\n\t\t}\r\n\t}\r\n\t\r\n\t.item{\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 34rpx;\r\n\t\ttransform: rotateX(180deg);\r\n\t\t// background-color: green;\r\n\t\t\r\n\t\t&-head{\r\n\t\t\tmargin-right: 28rpx;\r\n\t\t}\r\n\t\t\r\n\t\t&-img{\r\n\t\t\tmax-width: 100%;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tpadding-right: 68rpx;\r\n\t\t\t\r\n\t\t\t/deep/image{\r\n\t\t\t\tborder: 1px solid rgba(200,200,200,1);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/deep/.u-image__error{\r\n\t\t\t\tborder: 1px solid rgba(200,200,200,1);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t&-wrap{\r\n\t\t\tflex: 1; \r\n\t\t}\r\n\t\t\r\n\t\t&-content{\r\n\t\t\twidth: fit-content;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tpadding: 18rpx;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tcolor: rgba(11, 15, 18, 1);\r\n\t\t\tborder-radius: 12rpx;\r\n\t\t\tword-break: break-all;\r\n\t\t\tposition: relative;\r\n\t\t\t\r\n\t\t\t&:after{\r\n\t\t\t\tcontent: '';\r\n\t\t\t\twidth: 0;\r\n\t\t\t\theight: 0;\r\n\t\t\t\tborder-right: 14rpx solid #fff;\r\n\t\t\t\tborder-top: 10rpx solid transparent;\r\n\t\t\t\tborder-bottom: 10rpx solid transparent;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 10rpx;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\ttransform: translate(-90%,0);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t&-right{\r\n\t\t\tdirection:rtl;\r\n\t\t\t// background-color: pink;\r\n\t\t\t\r\n\t\t\t.item-head{\r\n\t\t\t\tmargin-right: 0;\r\n\t\t\t\tmargin-left: 28rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.item-img{\r\n\t\t\t\tpadding-right: 0;\r\n\t\t\t\tpadding-left: 68rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.item-content{\r\n\t\t\t\ttext-align: left;\r\n\t\t\t\tcolor: rgba(255, 255, 255, 1);\r\n\t\t\t\tbackground-color: rgba(0, 189, 253, 1);\r\n\t\t\t\t\r\n\t\t\t\t&:after{\r\n\t\t\t\t\tcontent: '';\r\n\t\t\t\t\twidth: 0;\r\n\t\t\t\t\theight: 0;\r\n\t\t\t\t\tborder-right: 0 solid transparent;\r\n\t\t\t\t\tborder-left: 14rpx solid rgba(0, 189, 253, 1);\r\n\t\t\t\t\tborder-top: 10rpx solid transparent;\r\n\t\t\t\t\tborder-bottom: 10rpx solid transparent;\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\ttop: 10rpx;\r\n\t\t\t\t\tright: 0;\r\n\t\t\t\t\ttransform: translate(90%,0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.bar{\r\n\t\twidth: 100%;\r\n\t\tbackground-color: rgba(240, 240, 242, 1);\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\tz-index: 9999;\r\n\t\ttransition: .3s;\r\n\t}\r\n\t\r\n\t.action{\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 14rpx 17rpx 14rpx 34rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-end;\r\n\t}\r\n\t\r\n\t.input{\r\n\t\tflex: 1;\r\n\t\tbox-sizing: border-box;\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 8rpx 0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\t\r\n\t\ttextarea{\r\n\t\t\tmax-height: 200rpx;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.more{\r\n\t\theight: 72rpx;\r\n\t\tpadding: 0 0 0 14rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\t\r\n\t\t\r\n\t\t.iconfont{\r\n\t\t\toverflow: hidden;\r\n\t\t\tfont-size: 54rpx;\r\n\t\t\tpadding: 0 14rpx;\r\n\t\t\ttransition: .3s;\r\n\t\t}\r\n\t\t\r\n\t\t.send{\r\n\t\t\toverflow: hidden;\r\n\t\t\ttransition: .3s;\r\n\t\t\t\r\n\t\t\t/deep/.u-btn{\r\n\t\t\t\theight: 60rpx;\r\n\t\t\t\tborder-radius: 6rpx;\r\n\t\t\t\tmargin: 0 14rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.choose{\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 24rpx 34rpx 30rpx;\r\n\t\t\r\n\t\t&-box{\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\tmargin-left: 50rpx;\r\n\t\t\t\r\n\t\t\t&:first-child{\r\n\t\t\t\tmargin-left: 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ttext{\r\n\t\t\t\tmargin-top: 20rpx;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: rgba(151, 155, 157, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t&-item{\r\n\t\t\twidth: 90rpx;\r\n\t\t\theight: 90rpx;\r\n\t\t\tbackground: #FCFCFC;\r\n\t\t\tborder-radius: 8rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tpadding-top: 4rpx;\r\n\t\t\t\r\n\t\t\t.iconfont{\r\n\t\t\t\tcolor: rgba(138, 138, 138, 1);\r\n\t\t\t\tfont-size: 56rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>\r\n","import mod from \"-!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\""],"sourceRoot":""}