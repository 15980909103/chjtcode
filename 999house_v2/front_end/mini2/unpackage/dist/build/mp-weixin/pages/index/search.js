(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/search"],{"2b3a":function(t,e,i){"use strict";i.r(e);var n=i("50bb"),s=i("f3db");for(var a in s)"default"!==a&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("8014");var o,r=i("f0c5"),c=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"79904d6f",null,!1,n["a"],o);e["default"]=c.exports},"50bb":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var n={uTabs:function(){return Promise.all([i.e("common/vendor"),i.e("uview-ui/components/u-tabs/u-tabs")]).then(i.bind(null,"f2ba"))},uSearch:function(){return i.e("uview-ui/components/u-search/u-search").then(i.bind(null,"5c9c"))},uEmpty:function(){return i.e("uview-ui/components/u-empty/u-empty").then(i.bind(null,"30a3"))},uLoadmore:function(){return i.e("uview-ui/components/u-loadmore/u-loadmore").then(i.bind(null,"9375"))}},s=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.tabList,(function(e,i){var n=t.__get_orig(e),s=t.active==i&&0==e.id?Object.keys(t.resultList):null;return{$orig:n,g0:s}})));t._isMounted||(t.e0=function(e){t.resultDetail=e},t.e1=function(e){t.resultDetail=e}),t.$mp.data=Object.assign({},{$root:{l0:i}})},a=[]},8014:function(t,e,i){"use strict";var n=i("9f35"),s=i.n(n);s.a},"9f35":function(t,e,i){},b849:function(t,e,i){"use strict";(function(t){i("e878");n(i("66fd"));var e=n(i("2b3a"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},d0e8:function(t,e,i){"use strict";function n(t){return r(t)||o(t)||a(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"===typeof t)return c(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(t,e):void 0}}function o(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function r(t){if(Array.isArray(t))return c(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var h=function(){i.e("components/common/template_information").then(function(){return resolve(i("9940"))}.bind(null,i)).catch(i.oe)},l=function(){i.e("components/common/template_newHouse").then(function(){return resolve(i("6f0c"))}.bind(null,i)).catch(i.oe)},u={data:function(){return{active:0,value:"",searchHistory:{},sortTab:{0:0,2:0,3:0},showResult:!1,showResultBox:!1,tabList:[{id:0,name:"综合",placeholder:"请输入资讯、楼盘、小区名或地址",historyKey:"all-search"},{id:1,name:"资讯",placeholder:"请输入感兴趣的内容",historyKey:"news-search"},{id:3,name:"新房",placeholder:"请输入楼盘、地址",historyKey:"house-search"}],hotTip:[],allSortList:{},sortList:[],infoList:[],resultList:{},resultDetail:[],page:0,maxPage:1,loading:!1,do_type:0,classify:{articles:"资讯",estates:"楼盘",videos:"视频"}}},components:{commonInformation:h,commonNewhouse:l},watch:{active:function(t){this.do_type=this.tabList[t].id}},computed:{loadState:function(){return 0==this.loading?this.page>=this.maxPage?"nomore":"loadmore":"loading"}},onLoad:function(t){this.do_type=t.type?t.type:0,this.searchHistory=this.uHistory("get"),this.initTab(),this.getHouseTip(),this.getHouseRank(),this.getHotNews()},methods:{init:function(){this.resultDetail=[],this.page=0,this.maxPage=1,this.loading=!1},initTab:function(){var t=this,e=this.do_type;e&&this.tabList.map((function(i,n){i.id!=e||(t.active=n)}))},getHouseTip:function(){var t=this;this.$http.post("estates/getSearchWords",{city_no:this.city_no}).then((function(e){var i=[],n=e.data;n.estates&&n.estates.length>0&&n.estates.map((function(t){var e={id:t.bind_id,name:t.name,type:0};i.push(e)})),n.tags&&n.tags.length>0&&n.tags.map((function(t){var e={id:t.bind_id,name:t.name,type:1};i.push(e)})),t.hotTip=i}))},getHouseRank:function(){var t=this;this.$http.post("rank/getEstatesRank",{region_id:this.city_no}).then((function(e){var i=e.data,n=[];for(var s in i)n=[],i[s].map((function(t){var e={id:t.estate_id,name:t.estate,site:t.area+" "+t.business_area,area:t.built_area,price:t.price};n.push(e)})),"popular"==s?t.allSortList[1]=n:t.allSortList[0]=n;t.sortTab[t.active]=0,t.allSortList[0]&&t.allSortList[0].length?t.sortList=t.allSortList[0]:t.allSortList[1]&&t.allSortList[1].length?(t.sortList=t.allSortList[1],t.sortTab[t.active]=1):t.sortList=[]}))},getHotNews:function(){var t=this;this.$http.post("news/getNewsRank",{city_no:this.city_no}).then((function(e){var i=e.data;t.infoList=i}))},goHotNews:function(t){this.goPage("discover/news_detail",{pid:9,cate_id:10,id:t})},goHotNewHouse:function(t){var e=t.detail_cover&&t.logo?1:0;this.goPage("houses/index",{id:t.id,cover:e})},tabChange:function(t){this.active=t,this.value="",this.showResult=this.showResultBox=!1,this.init(),this.allSortList[0].length?this.changeSort(0):this.allSortList[1].length&&this.changeSort(1)},uHistory:function(t){if("get"==t){var e=this.$api.localStore.localGet("u-index-search-history");return e||{}}if(t){var i=this.tabList[this.active].historyKey;-1==Object.keys(this.searchHistory).indexOf(String(i))&&this.$set(this.searchHistory,i,[]),-1!=this.searchHistory[i].indexOf(t)&&this.searchHistory[i].splice(this.searchHistory[i].indexOf(t),1),this.searchHistory[i].unshift(t),this.searchHistory[i].length>11&&(this.searchHistory[i].length=11)}this.$api.localStore.localSet("u-index-search-history",JSON.stringify(this.searchHistory))},onSearch:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(1!=this.loading){var s=this.page+1;if(s>this.maxPage)this.loading=!1;else{this.loading=!0,t?this.uHistory(t):t=this.value;var a=this.tabList[this.active].id;0==a?this.$http.post("search/getTotalSearch",{city_no:this.city_no,name:t}).then((function(t){e.resultList=t.data,e.showResult=e.showResultBox=!0,e.loading=!1})):1==a?this.$http.post("news/ColligateSearchSearch",{city_no:this.city_no,search_value:t,pid:i,page:s}).then((function(i){var s=i.data.list?i.data.list:[],a='\n\t\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\t\tclass="template-title-write" \n\t\t\t\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\t\t\t\tmargin-right: 4rpx;\n\t\t\t\t\t\t\t\t\theight: 30rpx;\n\t\t\t\t\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t\t\t\t\tpadding: 3rpx 10rpx !important;\n\t\t\t\t\t\t\t\t\tbackground: #FD4243;\n\t\t\t\t\t\t\t\t\tborder-radius: 2rpx;\n\t\t\t\t\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\t\t\t\t\tline-height: 30rpx;\n\t\t\t\t\t\t\t\t\tmargin-top: 0 !important;\n\t\t\t\t\t\t\t\t\ttext-align: center;"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t原创\n\t\t\t\t\t\t\t\t</span>';for(var o in s){var r=s[o];r.title&&(r.html_title=r.title.replace(t,'<p style="color:rgb(254, 130, 30);display: inline;">'+t+"</p>")),1==r.write&&(r.html_title=a+r.html_title)}e.resultDetail=[].concat(n(e.resultDetail),n(s)),e.showResult=e.showResultBox=!0,e.page=i.data.current_page,e.maxPage=i.data.last_page,e.loading=!1})):3==a&&this.$http.post("estates/getEstatesList",{city_no:this.city_no,name:t,no_adv:1,page:s,page_size:6}).then((function(t){var i=t.data,n=[];i.list&&i.list.length&&(n=e.$api.createHouseList(i)),e.resultDetail=e.resultDetail.concat(n),e.showResult=e.showResultBox=!0,e.page=i.current_page,e.maxPage=i.last_page,e.loading=!1}))}}},onInput:function(t){this.init(),0==t.length&&this.onClear()},onClear:function(){this.value="",this.init(),this.showResult=this.showResultBox=!1},delHistory:function(){var t=this.tabList[this.active].historyKey;this.$set(this.searchHistory,t,[]),this.uHistory()},tipClick:function(t){if("object"==typeof t){if(0==t.type)return void this.goPage("houses/index",{id:t.id,type:1});t=t.name}this.value=t,this.onSearch(t)},changeSort:function(t){if("number"==typeof t)this.sortTab[this.active]=t,this.sortList=this.allSortList[t];else{var e=this.sortTab[this.active],i=t.target.dataset.id;e!=i&&(this.sortTab[this.active]=i,this.sortList=this.allSortList[i])}},chooseClassify:function(t){var e=this,i=this.value,n="estates"==t?3:1,s=0;this.tabList.map((function(t,i){t.id==n&&(e.active=i)})),"articles"==t?s=9:"videos"==t&&(s=13),this.$nextTick((function(){e.init(),e.value=i,e.onSearch(i,s)}))}},onReachBottom:function(){this.value&&this.onSearch()}};e.default=u},f3db:function(t,e,i){"use strict";i.r(e);var n=i("d0e8"),s=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a}},[["b849","common/runtime","common/vendor"]]]);