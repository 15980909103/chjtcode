(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/authorize/index"],{"21a1":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=getApp(),n=null,o={data:function(){return{isclick:!1,doType:"userinfo",canIUse:e.canIUse("button.open-type.getUserInfo"),hasGetMobile:1}},onLoad:function(){n=this,e.getSetting({success:function(e){e.authSetting["scope.userInfo"]&&a.globalData.token&&1==n.hasGetMobile?n.$data.doType="mobile":n.$data.doType="userinfo"},fail:function(){n.$data.doType="userinfo"}})},methods:{bindGetUserInfo:function(t){1!=n.$data.isclick&&(n.$data.isclick=!0,t.detail.encryptedData?n.$api.wxMiniAuthLogin(a,{encryptedData:t.detail.encryptedData,iv:t.detail.iv}).then((function(t){n.$data.isclick=!1,console.log(t,"authpage"),t?1==n.hasGetMobile?(n.$data.doType="",e.showLoading({title:"加载中"}),setTimeout((function(){e.hideLoading(),n.$data.doType="mobile"}),300)):n.doResponse(t):n.$toast("授权失败:"+t+"请重试")})):(n.$data.isclick=!1,console.log("授权失败")))},cancel:function(){var e=getCurrentPages();e.length>1?n.goPage(-1):n.goPage("index/index","","reLaunch"),a.globalData.restopen=""},getphonenumber:function(e){1!=n.$data.isclick&&(n.$data.isclick=!0,e.detail&&e.detail.encryptedData?n.$api.getMiniMobile({url:"public/getWxPhone",encryptedData:e.detail.encryptedData,iv:e.detail.iv}).then((function(e){n.$data.isclick=!1,n.doResponse(e)})).catch((function(e){console.log(e)})):e.detail&&-1!=e.detail.errMsg.indexOf("user deny")?n.$data.isclick=!1:(n.$data.isclick=!1,n.$toast("手机获取失败")))},doResponse:function(e){a.globalData.userInfo||(a.globalData.userInfo={}),a.globalData.userInfo=Object.assign(a.globalData.userInfo,e),n.$api.getUserInfoByCache(e);var t=getCurrentPages();if(t.length>1)a.globalData.restopen?n.goPage(a.globalData.restopen,"","redirectTo"):n.goPage(-1);else{var o=n.$api.getLaunchData();n.goPage(o.$url,"","reLaunch")}a.globalData.restopen=""}}};t.default=o}).call(this,a("543d")["default"])},"46af":function(e,t,a){"use strict";var n=a("7afd"),o=a.n(n);o.a},"6e70":function(e,t,a){"use strict";(function(e){a("e878");n(a("66fd"));var t=n(a("bf91"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},"71cb":function(e,t,a){"use strict";a.r(t);var n=a("21a1"),o=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},"7afd":function(e,t,a){},"914e":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}));var o=function(){var e=this,t=e.$createElement,a=(e._self._c,e.doType?e.$api.imgDirtoUrl("/my/logo.png"):null);e.$mp.data=Object.assign({},{$root:{g0:a}})},i=[]},bf91:function(e,t,a){"use strict";a.r(t);var n=a("914e"),o=a("71cb");for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("46af");var c,l=a("f0c5"),u=Object(l["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);t["default"]=u.exports}},[["6e70","common/runtime","common/vendor"]]]);