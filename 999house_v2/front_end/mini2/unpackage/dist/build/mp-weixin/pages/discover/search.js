(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/discover/search"],{"305c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){i.e("components/common/template_information").then(function(){return resolve(i("9940"))}.bind(null,i)).catch(i.oe)},s=function(){i.e("components/common/template_newHouse").then(function(){return resolve(i("6f0c"))}.bind(null,i)).catch(i.oe)},a={data:function(){return{active:0,value:"",searchHistory:{},sortTab:{0:0,2:0,3:0},showResult:!1,showResultBox:!1,tabList:[{id:0,name:"资讯",historyKey:"news-search",placeholder:"请输入感兴趣的内容"},{id:2,name:"选好房",historyKey:"house-search",placeholder:"请输入楼盘、地址"}],pid:9,hotTip:[],resultDetail:[],page:0,maxPage:1,loading:!1,do_type:0}},components:{commonInformation:n,commonNewhouse:s},watch:{active:function(t){this.do_type=this.tabList[t].id}},computed:{loadState:function(){return 0==this.loading?this.page>=this.maxPage?"nomore":"loadmore":"loading"}},onLoad:function(){this.searchHistory=this.uHistory("get"),this.getHouseTip()},methods:{init:function(){this.resultDetail=[],this.page=0,this.maxPage=1,this.loading=!1},tabChange:function(t){switch(this.active=t,this.tabList[t].id){case 0:this.pid=9;break;case 1:this.pid=13;break;case 2:this.pid=18;break;default:this.pid=9}this.value="",this.showResult=this.showResultBox=!1,this.init()},getHouseTip:function(){var t=this;this.$http.post("estates/getSearchWords",{city_no:this.city_no}).then((function(e){var i=[],n=e.data;n.estates&&n.estates.length>0&&n.estates.map((function(t){var e={id:t.bind_id,name:t.name,type:0};i.push(e)})),n.tags&&n.tags.length>0&&n.tags.map((function(t){var e={id:t.bind_id,name:t.name,type:1};i.push(e)})),t.hotTip=i}))},uHistory:function(t){if("get"==t){var e=this.$api.localStore.localGet("u-index-search-history");return e||{}}if(t){var i=this.tabList[this.active].historyKey;-1==Object.keys(this.searchHistory).indexOf(String(i))&&this.$set(this.searchHistory,i,[]),-1!=this.searchHistory[i].indexOf(t)&&this.searchHistory[i].splice(this.searchHistory[i].indexOf(t),1),this.searchHistory[i].unshift(t),this.searchHistory[i].length>11&&(this.searchHistory[i].length=11)}this.$api.localStore.localSet("u-index-search-history",JSON.stringify(this.searchHistory))},onInput:function(t){this.init(),0==t.length&&this.onClear()},onClear:function(){this.value="",this.init(),this.showResult=this.showResultBox=!1},onCancel:function(){this.goPage(-1)},delHistory:function(){var t=this.tabList[this.active].historyKey;this.$set(this.searchHistory,t,[]),this.uHistory()},tipClick:function(t){if("object"==typeof t){if(0==t.type)return void this.goPage("houses/index",{id:t.id,type:1});t=t.name}this.value=t,this.onSearch(t,1)},onSearch:function(t){var e=this;if(1!=this.loading){this.loading=!0;var i=this.page+1;i>this.maxPage?this.loading=!1:(t?this.uHistory(t):t=this.value,2!=this.tabList[this.active].id?this.$http.post("/news/newsSearch",{pid:this.pid,city_no:this.city_no,search_value:t,page:i}).then((function(i){var n=e,s=i.data.list?i.data.list:[],a='<span \n\t\t\t\t\t\t\t\t\tclass="template-title-write" \n\t\t\t\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t\t\t\t\tmargin-right: 4rpx;\n\t\t\t\t\t\t\t\t\theight: 30rpx;\n\t\t\t\t\t\t\t\t\tfont-size: 20rpx;\n\t\t\t\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t\t\t\t\tpadding: 3rpx 10rpx !important;\n\t\t\t\t\t\t\t\t\tbackground: #FD4243;\n\t\t\t\t\t\t\t\t\tborder-radius: 2rpx;\n\t\t\t\t\t\t\t\t\tvertical-align: middle;\n\t\t\t\t\t\t\t\t\tline-height: 30rpx;\n\t\t\t\t\t\t\t\t\tmargin-top: 0 !important;\n\t\t\t\t\t\t\t\t\ttext-align: center;"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t原创\n\t\t\t\t\t\t\t\t</span>';s&&s.forEach((function(e,i){e.type=1,e.title&&(e.html_title=e.title.replace(t,'<p style="color:rgb(254, 130, 30);display: inline;">'+t+"</p>")),1==e.write&&(e.html_title=a+e.html_title),e.img instanceof Array?e.img.length>0&&e.img.forEach((function(t,e){s[i]["img"][e]=n.$api.imgDirtoUrl(t)})):s[i]["url"]=n.$api.imgDirtoUrl(e.url)})),e.resultDetail=e.resultDetail.concat(s),e.showResult=e.showResultBox=!0,e.page=i.data.current_page,e.maxPage=i.data.last_page,e.loading=!1})):this.$http.post("/estates/getEstatesList",{city_no:this.city_no,name:t,recommend:1,no_adv:1,page:i,page_size:6}).then((function(t){var i=t.data,n=[];i.list&&i.list.length&&(n=e.$api.createHouseList(i)),e.resultDetail=e.resultDetail.concat(n),e.showResult=e.showResultBox=!0,e.page=i.current_page,e.maxPage=i.last_page,e.loading=!1})))}},onReachBottom:function(){this.value&&this.onSearch()}}};e.default=a},"4e18":function(t,e,i){"use strict";var n=i("dcf4"),s=i.n(n);s.a},8650:function(t,e,i){"use strict";(function(t){i("e878");n(i("66fd"));var e=n(i("9383"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},9383:function(t,e,i){"use strict";i.r(e);var n=i("e9b4"),s=i("c313");for(var a in s)"default"!==a&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("4e18");var o,r=i("f0c5"),c=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"37d0f4aa",null,!1,n["a"],o);e["default"]=c.exports},c313:function(t,e,i){"use strict";i.r(e);var n=i("305c"),s=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a},dcf4:function(t,e,i){},e9b4:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var n={uTabs:function(){return Promise.all([i.e("common/vendor"),i.e("uview-ui/components/u-tabs/u-tabs")]).then(i.bind(null,"f2ba"))},uSearch:function(){return i.e("uview-ui/components/u-search/u-search").then(i.bind(null,"5c9c"))},uEmpty:function(){return i.e("uview-ui/components/u-empty/u-empty").then(i.bind(null,"30a3"))},uLoadmore:function(){return i.e("uview-ui/components/u-loadmore/u-loadmore").then(i.bind(null,"9375"))}},s=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.resultDetail=e},t.e1=function(e){t.resultDetail=e})},a=[]}},[["8650","common/runtime","common/vendor"]]]);